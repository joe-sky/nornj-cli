(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{259:function(e,t,s){"use strict";s.r(t);var a=s(0),n=Object(a.a)({},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[s("h1",{attrs:{id:"vue-cli-plugin-unit-jest"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#vue-cli-plugin-unit-jest","aria-hidden":"true"}},[e._v("#")]),e._v(" @vue/cli-plugin-unit-jest")]),e._v(" "),s("blockquote",[s("p",[e._v("unit-jest plugin for vue-cli")])]),e._v(" "),s("h2",{attrs:{id:"injected-commands"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#injected-commands","aria-hidden":"true"}},[e._v("#")]),e._v(" Injected Commands")]),e._v(" "),s("ul",[s("li",[s("p",[s("strong",[s("code",[e._v("vue-cli-service test:unit")])])]),e._v(" "),s("p",[e._v("Run unit tests with Jest. Default "),s("code",[e._v("testMatch")]),e._v(" is "),s("code",[e._v("<rootDir>/(tests/unit/**/*.spec.(js|jsx|ts|tsx)|**/__tests__/*.(js|jsx|ts|tsx))")]),e._v(" which matches:")]),e._v(" "),s("ul",[s("li",[e._v("Any files in "),s("code",[e._v("tests/unit")]),e._v(" that end in "),s("code",[e._v(".spec.(js|jsx|ts|tsx)")]),e._v(";")]),e._v(" "),s("li",[e._v("Any js(x)/ts(x) files inside "),s("code",[e._v("__tests__")]),e._v(" directories.")])]),e._v(" "),s("p",[e._v("Usage: "),s("code",[e._v("vue-cli-service test:unit [options] <regexForTestFiles>")])]),e._v(" "),s("p",[e._v("All "),s("a",{attrs:{href:"https://facebook.github.io/jest/docs/en/cli.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("Jest command line options"),s("OutboundLink")],1),e._v(" are also supported.")])])]),e._v(" "),s("h2",{attrs:{id:"debugging-tests"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#debugging-tests","aria-hidden":"true"}},[e._v("#")]),e._v(" Debugging Tests")]),e._v(" "),s("p",[e._v("Note that directly running "),s("code",[e._v("jest")]),e._v(" will fail because the Babel preset requires hints to make your code work in Node.js, so you must run your tests with "),s("code",[e._v("vue-cli-service test:unit")]),e._v(".")]),e._v(" "),s("p",[e._v("If you want to debug your tests via the Node inspector, you can run the following:")]),e._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# macOS or linux")]),e._v("\nnode --inspect-brk ./node_modules/.bin/vue-cli-service test:unit\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# Windows")]),e._v("\nnode --inspect-brk ./node_modules/@vue/cli-service/bin/vue-cli-service.js test:unit\n")])])]),s("h2",{attrs:{id:"configuration"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#configuration","aria-hidden":"true"}},[e._v("#")]),e._v(" Configuration")]),e._v(" "),s("p",[e._v("Jest can be configured via "),s("code",[e._v("jest.config.js")]),e._v(" in your project root, or the "),s("code",[e._v("jest")]),e._v(" field in "),s("code",[e._v("package.json")]),e._v(".")]),e._v(" "),s("h2",{attrs:{id:"installing-in-an-already-created-project"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#installing-in-an-already-created-project","aria-hidden":"true"}},[e._v("#")]),e._v(" Installing in an Already Created Project")]),e._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[e._v("vue "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("add")]),e._v(" @vue/unit-jest\n")])])]),s("h2",{attrs:{id:"transform-dependencies-from-node-modules"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#transform-dependencies-from-node-modules","aria-hidden":"true"}},[e._v("#")]),e._v(" Transform dependencies from "),s("code",[e._v("/node_modules")])]),e._v(" "),s("p",[e._v("By default, jest doesn't transform anything from "),s("code",[e._v("/node_modules")]),e._v(".")]),e._v(" "),s("p",[e._v("Since jest runs in node, we also don't have to transpile anything that uses modern ECMAScript features as Node >=8 already supports these features, so it's a sensible default. cli-plugin-jest also doesn't respect the "),s("code",[e._v("transpileDependencies")]),e._v(" option in "),s("code",[e._v("vue.config.js")]),e._v(" for the same reason.")]),e._v(" "),s("p",[e._v("However, we have (at least) three cases where we do need to transpile code from "),s("code",[e._v("/node_modules")]),e._v(" in jest:")]),e._v(" "),s("ol",[s("li",[e._v("Usage of ES6 "),s("code",[e._v("import")]),e._v("/"),s("code",[e._v("export")]),e._v(" statements, which have to be compiled to commonjs "),s("code",[e._v("module.exports")])]),e._v(" "),s("li",[e._v("Single File Components ("),s("code",[e._v(".vue")]),e._v(" files) which have to be run through "),s("code",[e._v("vue-jest")])]),e._v(" "),s("li",[e._v("Typescript code")])]),e._v(" "),s("p",[e._v("To do this, we need to add an exception to the "),s("code",[e._v("transformIgnorePatterns")]),e._v(" option of jest. This is its default value:")]),e._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[e._v("transformIgnorePatterns"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[e._v("'/node_modules/'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),e._v("\n")])])]),s("p",[e._v("We have to add exceptions to this pattern with a RegExp negative lookahead:")]),e._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[e._v("transformIgnorePatterns"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[e._v("'/node_modules/(?!name-of-lib-o-transform)'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),e._v("\n")])])]),s("p",[e._v("To exclude multiple libraries:")]),e._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[e._v("transformIgnorePatterns"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[e._v("'/node_modules/(?!lib-to-transform|other-lib)'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),e._v("\n")])])])])},[],!1,null,null,null);t.default=n.exports}}]);