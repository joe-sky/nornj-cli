<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Plugin Development Guide | NornJ CLI</title>
    <meta name="description" content="🛠️ An Easily Configurable and Scalable Scaffolding tool">
    <link rel="icon" href="/nornj-cli/favicon.png">
  <link rel="manifest" href="/nornj-cli/manifest.json">
  <meta name="theme-color" content="#3eaf7c">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <link rel="apple-touch-icon" href="/nornj-cli/icons/apple-touch-icon-152x152.png">
  <link rel="mask-icon" href="/nornj-cli/icons/safari-pinned-tab.svg" color="#3eaf7c">
  <meta name="msapplication-TileImage" content="/icons/msapplication-icon-144x144.png">
  <meta name="msapplication-TileColor" content="#000000">
    
    <link rel="preload" href="/nornj-cli/assets/css/0.styles.f1bfe761.css" as="style"><link rel="preload" href="/nornj-cli/assets/js/app.261fa4a4.js" as="script"><link rel="preload" href="/nornj-cli/assets/js/3.bc847c09.js" as="script"><link rel="preload" href="/nornj-cli/assets/js/20.3cd1f9b8.js" as="script"><link rel="prefetch" href="/nornj-cli/assets/js/10.71560345.js"><link rel="prefetch" href="/nornj-cli/assets/js/11.0b95383d.js"><link rel="prefetch" href="/nornj-cli/assets/js/12.df985099.js"><link rel="prefetch" href="/nornj-cli/assets/js/13.430cdf18.js"><link rel="prefetch" href="/nornj-cli/assets/js/14.c6a216b4.js"><link rel="prefetch" href="/nornj-cli/assets/js/15.6336aba1.js"><link rel="prefetch" href="/nornj-cli/assets/js/16.b9c9eed8.js"><link rel="prefetch" href="/nornj-cli/assets/js/17.f1857aac.js"><link rel="prefetch" href="/nornj-cli/assets/js/18.5d12849b.js"><link rel="prefetch" href="/nornj-cli/assets/js/19.a2ed0afb.js"><link rel="prefetch" href="/nornj-cli/assets/js/21.d4ec2cde.js"><link rel="prefetch" href="/nornj-cli/assets/js/22.fb94c59a.js"><link rel="prefetch" href="/nornj-cli/assets/js/23.510d0506.js"><link rel="prefetch" href="/nornj-cli/assets/js/24.bb3e705c.js"><link rel="prefetch" href="/nornj-cli/assets/js/25.2f0883d4.js"><link rel="prefetch" href="/nornj-cli/assets/js/26.cc95afe5.js"><link rel="prefetch" href="/nornj-cli/assets/js/27.2b4cf4d0.js"><link rel="prefetch" href="/nornj-cli/assets/js/28.0677e297.js"><link rel="prefetch" href="/nornj-cli/assets/js/29.7be9099e.js"><link rel="prefetch" href="/nornj-cli/assets/js/30.b61b8509.js"><link rel="prefetch" href="/nornj-cli/assets/js/31.3678a010.js"><link rel="prefetch" href="/nornj-cli/assets/js/32.a7cd9e25.js"><link rel="prefetch" href="/nornj-cli/assets/js/33.bc2e2cf5.js"><link rel="prefetch" href="/nornj-cli/assets/js/34.256ebe73.js"><link rel="prefetch" href="/nornj-cli/assets/js/35.e0a1c1a8.js"><link rel="prefetch" href="/nornj-cli/assets/js/36.56fdf07f.js"><link rel="prefetch" href="/nornj-cli/assets/js/37.203d8c17.js"><link rel="prefetch" href="/nornj-cli/assets/js/38.ad005fb0.js"><link rel="prefetch" href="/nornj-cli/assets/js/39.4991a369.js"><link rel="prefetch" href="/nornj-cli/assets/js/4.b3425f3c.js"><link rel="prefetch" href="/nornj-cli/assets/js/40.e7f84947.js"><link rel="prefetch" href="/nornj-cli/assets/js/41.0bb8da68.js"><link rel="prefetch" href="/nornj-cli/assets/js/42.a8d54bd0.js"><link rel="prefetch" href="/nornj-cli/assets/js/43.81ec9ade.js"><link rel="prefetch" href="/nornj-cli/assets/js/44.6087ec7c.js"><link rel="prefetch" href="/nornj-cli/assets/js/45.398edd74.js"><link rel="prefetch" href="/nornj-cli/assets/js/46.16d2db5d.js"><link rel="prefetch" href="/nornj-cli/assets/js/47.2272003f.js"><link rel="prefetch" href="/nornj-cli/assets/js/48.ac7336ae.js"><link rel="prefetch" href="/nornj-cli/assets/js/49.f9a296c9.js"><link rel="prefetch" href="/nornj-cli/assets/js/5.a1c47062.js"><link rel="prefetch" href="/nornj-cli/assets/js/50.c22cefbe.js"><link rel="prefetch" href="/nornj-cli/assets/js/51.9d6f247f.js"><link rel="prefetch" href="/nornj-cli/assets/js/52.81bc0e56.js"><link rel="prefetch" href="/nornj-cli/assets/js/53.d38df6d7.js"><link rel="prefetch" href="/nornj-cli/assets/js/54.944047c2.js"><link rel="prefetch" href="/nornj-cli/assets/js/55.7ad50c4a.js"><link rel="prefetch" href="/nornj-cli/assets/js/56.2715648f.js"><link rel="prefetch" href="/nornj-cli/assets/js/57.a91747e2.js"><link rel="prefetch" href="/nornj-cli/assets/js/58.7613de44.js"><link rel="prefetch" href="/nornj-cli/assets/js/59.106fb976.js"><link rel="prefetch" href="/nornj-cli/assets/js/6.9275d20c.js"><link rel="prefetch" href="/nornj-cli/assets/js/60.04a83941.js"><link rel="prefetch" href="/nornj-cli/assets/js/61.187d092f.js"><link rel="prefetch" href="/nornj-cli/assets/js/62.3e07a9e7.js"><link rel="prefetch" href="/nornj-cli/assets/js/63.c64152ae.js"><link rel="prefetch" href="/nornj-cli/assets/js/64.402b88dd.js"><link rel="prefetch" href="/nornj-cli/assets/js/65.c9a7394b.js"><link rel="prefetch" href="/nornj-cli/assets/js/66.34099aad.js"><link rel="prefetch" href="/nornj-cli/assets/js/67.7ad0e778.js"><link rel="prefetch" href="/nornj-cli/assets/js/68.acf93dfe.js"><link rel="prefetch" href="/nornj-cli/assets/js/69.0cc0ff29.js"><link rel="prefetch" href="/nornj-cli/assets/js/7.4eafd19b.js"><link rel="prefetch" href="/nornj-cli/assets/js/70.28a141d8.js"><link rel="prefetch" href="/nornj-cli/assets/js/71.ec4a6399.js"><link rel="prefetch" href="/nornj-cli/assets/js/72.e63aa437.js"><link rel="prefetch" href="/nornj-cli/assets/js/73.21ebb547.js"><link rel="prefetch" href="/nornj-cli/assets/js/8.e0b21abc.js"><link rel="prefetch" href="/nornj-cli/assets/js/9.1ff32274.js"><link rel="prefetch" href="/nornj-cli/assets/js/vendors~docsearch.192c4e2d.js">
    <link rel="stylesheet" href="/nornj-cli/assets/css/0.styles.f1bfe761.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/nornj-cli/" class="home-link router-link-active"><!----> <span class="site-name">NornJ CLI</span></a> <div class="links"><form id="search-form" role="search" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"><div class="nav-item"><a href="/nornj-cli/guide/" class="nav-link">Guide</a></div><div class="nav-item"><a href="/nornj-cli/config/" class="nav-link">Config Reference</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Plugin Dev Guide</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/nornj-cli/dev-guide/plugin-dev.html" class="nav-link router-link-exact-active router-link-active">Plugin Dev Guide</a></li><li class="dropdown-item"><!----> <a href="/nornj-cli/dev-guide/ui-info.html" class="nav-link">UI Plugin Info</a></li><li class="dropdown-item"><!----> <a href="/nornj-cli/dev-guide/ui-api.html" class="nav-link">UI Plugin API</a></li><li class="dropdown-item"><!----> <a href="/nornj-cli/dev-guide/ui-localization.html" class="nav-link">UI Localization</a></li></ul></div></div><div class="nav-item"><a href="/nornj-cli/core-plugins/" class="nav-link">Plugins</a></div><div class="nav-item"><a href="https://github.com/vuejs/vue-cli/blob/dev/CHANGELOG.md" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Changelog
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/nornj-cli/dev-guide/plugin-dev.html" class="nav-link router-link-exact-active router-link-active">English</a></li><li class="dropdown-item"><!----> <a href="/nornj-cli/zh/dev-guide/plugin-dev.html" class="nav-link">简体中文</a></li></ul></div></div> <a href="https://github.com/joe-sky/nornj-cli" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/nornj-cli/guide/" class="nav-link">Guide</a></div><div class="nav-item"><a href="/nornj-cli/config/" class="nav-link">Config Reference</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Plugin Dev Guide</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/nornj-cli/dev-guide/plugin-dev.html" class="nav-link router-link-exact-active router-link-active">Plugin Dev Guide</a></li><li class="dropdown-item"><!----> <a href="/nornj-cli/dev-guide/ui-info.html" class="nav-link">UI Plugin Info</a></li><li class="dropdown-item"><!----> <a href="/nornj-cli/dev-guide/ui-api.html" class="nav-link">UI Plugin API</a></li><li class="dropdown-item"><!----> <a href="/nornj-cli/dev-guide/ui-localization.html" class="nav-link">UI Localization</a></li></ul></div></div><div class="nav-item"><a href="/nornj-cli/core-plugins/" class="nav-link">Plugins</a></div><div class="nav-item"><a href="https://github.com/vuejs/vue-cli/blob/dev/CHANGELOG.md" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Changelog
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/nornj-cli/dev-guide/plugin-dev.html" class="nav-link router-link-exact-active router-link-active">English</a></li><li class="dropdown-item"><!----> <a href="/nornj-cli/zh/dev-guide/plugin-dev.html" class="nav-link">简体中文</a></li></ul></div></div> <a href="https://github.com/joe-sky/nornj-cli" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><a href="/nornj-cli/dev-guide/plugin-dev.html" class="active sidebar-link">Plugin Development Guide</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/nornj-cli/dev-guide/plugin-dev.html#getting-started" class="sidebar-link">Getting started</a></li><li class="sidebar-sub-header"><a href="/nornj-cli/dev-guide/plugin-dev.html#naming-and-discoverability" class="sidebar-link">Naming and discoverability</a></li><li class="sidebar-sub-header"><a href="/nornj-cli/dev-guide/plugin-dev.html#generator" class="sidebar-link">Generator</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/nornj-cli/dev-guide/plugin-dev.html#creating-new-templates" class="sidebar-link">Creating new templates</a></li><li class="sidebar-sub-header"><a href="/nornj-cli/dev-guide/plugin-dev.html#editing-existing-templates" class="sidebar-link">Editing existing templates</a></li><li class="sidebar-sub-header"><a href="/nornj-cli/dev-guide/plugin-dev.html#filename-edge-cases" class="sidebar-link">Filename edge cases</a></li><li class="sidebar-sub-header"><a href="/nornj-cli/dev-guide/plugin-dev.html#extending-package" class="sidebar-link">Extending package</a></li><li class="sidebar-sub-header"><a href="/nornj-cli/dev-guide/plugin-dev.html#changing-main-file" class="sidebar-link">Changing main file</a></li></ul></li><li class="sidebar-sub-header"><a href="/nornj-cli/dev-guide/plugin-dev.html#service-plugin" class="sidebar-link">Service Plugin</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/nornj-cli/dev-guide/plugin-dev.html#modifying-webpack-config" class="sidebar-link">Modifying webpack config</a></li><li class="sidebar-sub-header"><a href="/nornj-cli/dev-guide/plugin-dev.html#add-a-new-cli-service-command" class="sidebar-link">Add a new cli-service command</a></li><li class="sidebar-sub-header"><a href="/nornj-cli/dev-guide/plugin-dev.html#modifying-existing-cli-service-command" class="sidebar-link">Modifying existing cli-service command</a></li><li class="sidebar-sub-header"><a href="/nornj-cli/dev-guide/plugin-dev.html#specifying-mode-for-commands" class="sidebar-link">Specifying Mode for Commands</a></li></ul></li><li class="sidebar-sub-header"><a href="/nornj-cli/dev-guide/plugin-dev.html#prompts" class="sidebar-link">Prompts</a></li><li class="sidebar-sub-header"><a href="/nornj-cli/dev-guide/plugin-dev.html#installing-plugin-locally" class="sidebar-link">Installing plugin locally</a></li><li class="sidebar-sub-header"><a href="/nornj-cli/dev-guide/plugin-dev.html#ui-integration" class="sidebar-link">UI Integration</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/nornj-cli/dev-guide/plugin-dev.html#augment-the-task-in-the-ui" class="sidebar-link">Augment the task in the UI</a></li><li class="sidebar-sub-header"><a href="/nornj-cli/dev-guide/plugin-dev.html#display-a-configuration-screen" class="sidebar-link">Display a configuration screen</a></li><li class="sidebar-sub-header"><a href="/nornj-cli/dev-guide/plugin-dev.html#display-prompts" class="sidebar-link">Display prompts</a></li><li class="sidebar-sub-header"><a href="/nornj-cli/dev-guide/plugin-dev.html#logo" class="sidebar-link">Logo</a></li></ul></li><li class="sidebar-sub-header"><a href="/nornj-cli/dev-guide/plugin-dev.html#publish-plugin-to-npm" class="sidebar-link">Publish Plugin to npm</a></li></ul></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>API reference</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/nornj-cli/dev-guide/plugin-api.html" class="sidebar-link">Plugin API</a></li><li><a href="/nornj-cli/dev-guide/generator-api.html" class="sidebar-link">Generator API</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>UI Development</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/nornj-cli/dev-guide/ui-info.html" class="sidebar-link">UI Plugin Info</a></li><li><a href="/nornj-cli/dev-guide/ui-api.html" class="sidebar-link">UI API</a></li><li><a href="/nornj-cli/dev-guide/ui-localization.html" class="sidebar-link">UI Localization</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="plugin-development-guide"><a href="#plugin-development-guide" aria-hidden="true" class="header-anchor">#</a> Plugin Development Guide</h1> <h2 id="getting-started"><a href="#getting-started" aria-hidden="true" class="header-anchor">#</a> Getting started</h2> <p>A CLI plugin is an npm package that can add additional features to the project using Vue CLI. These features can include:</p> <ul><li>changing project webpack config - for example, you can add a new webpack resolve rule for a certain file extension, if your plugin is supposed to work with this type of files. Say, <code>@vue/cli-plugin-typescript</code> adds such rule to resolve <code>.ts</code> and <code>.tsx</code> extensions;</li> <li>adding new vue-cli-service command - for example, <code>@vue/cli-plugin-unit-jest</code> adds a new command <code>test:unit</code> that allows developer to run unit tests;</li> <li>extending <code>package.json</code> - a useful option when your plugin adds some dependencies to the project and you need to add them to package dependencies section;</li> <li>creating new files in the project and/or modifying old ones. Sometimes it's a good idea to create an example component or modify a main file to add some imports;</li> <li>prompting user to select certain options - for example, you can ask user if they want to create the example component mentioned above.</li></ul> <div class="tip custom-block"><p>Don't overuse vue-cli plugins! If you want just to include a certain dependency, e.g. <a href="https://lodash.com/" target="_blank" rel="noopener noreferrer">Lodash<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> - it's easier to do it manually with npm than create a specific plugin only to do so.</p></div> <p>CLI Plugin should always contain a <a href="#service-plugin">Service Plugin</a> as its main export, and can optionally contain a <a href="#generator">Generator</a>, a <a href="#prompts">Prompt File</a> and a <a href="#ui-integration">Vue UI integration</a>.</p> <p>As an npm package, CLI plugin must have a <code>package.json</code> file. It's also recommended to have a plugin description in <code>README.md</code> to help others find your plugin on npm.</p> <p>So, typical CLI plugin folder structure looks like the following:</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token keyword">.</span>
├── README.md
├── generator.js  <span class="token comment"># generator (optional)</span>
├── index.js      <span class="token comment"># service plugin</span>
├── package.json
├── prompts.js    <span class="token comment"># prompts file (optional)</span>
└── ui.js         <span class="token comment"># Vue UI integration (optional)</span>
</code></pre></div><h2 id="naming-and-discoverability"><a href="#naming-and-discoverability" aria-hidden="true" class="header-anchor">#</a> Naming and discoverability</h2> <p>For a CLI plugin to be usable in a Vue CLI project, it must follow the name convention <code>vue-cli-plugin-&lt;name&gt;</code> or <code>@scope/vue-cli-plugin-&lt;name&gt;</code>. It allows your plugin to be:</p> <ul><li>Discoverable by <code>@vue/cli-service</code>;</li> <li>Discoverable by other developers via searching;</li> <li>Installable via <code>vue add &lt;name&gt;</code> or <code>vue invoke &lt;name&gt;</code>.</li></ul> <div class="warning custom-block"><p class="custom-block-title">Warning</p> <p>Make sure to name the plugin correctly, otherwise it will be impossible to install it via <code>vue add</code> command or find it with Vue UI plugins search!</p></div> <p>For better discoverability when a user searches for your plugin, put keywords describing your plugin in the <code>description</code> field of the plugin <code>package.json</code> file.</p> <p>Example:</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;vue-cli-plugin-apollo&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;version&quot;</span><span class="token operator">:</span> <span class="token string">&quot;0.7.7&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;description&quot;</span><span class="token operator">:</span> <span class="token string">&quot;vue-cli plugin to add Apollo and GraphQL&quot;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>You should add the url to the plugin website or repository in the <code>homepage</code> or <code>repository</code> field so that a 'More info' button will be displayed in your plugin description:</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;repository&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;git&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;url&quot;</span><span class="token operator">:</span> <span class="token string">&quot;git+https://github.com/Akryum/vue-cli-plugin-apollo.git&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;homepage&quot;</span><span class="token operator">:</span> <span class="token string">&quot;https://github.com/Akryum/vue-cli-plugin-apollo#readme&quot;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><img src="/plugin-search-item.png" alt="Plugin search item"></p> <h2 id="generator"><a href="#generator" aria-hidden="true" class="header-anchor">#</a> Generator</h2> <p>A Generator part of the CLI plugin is usually needed when you want to extend your package with new dependencies, create new files in your project or edit existing ones.</p> <p>Inside the CLI plugin the generator should be placed in a <code>generator.js</code> or <code>generator/index.js</code> file. It will be invoked in two possible scenarios:</p> <ul><li><p>During a project's initial creation, if the CLI plugin is installed as part of the project creation preset.</p></li> <li><p>When the plugin is installed after project's creation and invoked individually via <code>vue add</code> or <code>vue invoke</code>.</p></li></ul> <p>A generator should export a function which receives three arguments:</p> <ol><li><p>A <a href="/nornj-cli/dev-guide/generator-api.html">GeneratorAPI</a> instance;</p></li> <li><p>The generator options for this plugin. These options are resolved during the <a href="#prompts">prompt</a> phase of project creation, or loaded from a saved preset in <code>~/.vuerc</code>. For example, if the saved <code>~/.vuerc</code> looks like this:</p></li></ol> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;presets&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;foo&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;plugins&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;@vue/cli-plugin-foo&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;option&quot;</span><span class="token operator">:</span> <span class="token string">&quot;bar&quot;</span> <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>And if the user creates a project using the <code>foo</code> preset, then the generator of <code>@vue/cli-plugin-foo</code> will receive <code>{ option: 'bar' }</code> as its second argument.</p> <p>For a 3rd party plugin, the options will be resolved from the prompts or command line arguments when the user executes <code>vue invoke</code> (see <a href="#prompts">Prompts</a>).</p> <ol start="3"><li>The entire preset (<code>presets.foo</code>) will be passed as the third argument.</li></ol> <h3 id="creating-new-templates"><a href="#creating-new-templates" aria-hidden="true" class="header-anchor">#</a> Creating new templates</h3> <p>When you call <code>api.render('./template')</code>, the generator will render files in <code>./template</code> (resolved relative to the generator file) with <a href="https://github.com/mde/ejs" target="_blank" rel="noopener noreferrer">EJS<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <p>Let's imagine we're creating <a href="https://github.com/ktsn/vue-cli-plugin-auto-routing" target="_blank" rel="noopener noreferrer">vue-cli-auto-routing<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> plugin and we want to make the following changes to the project on plugin invoke:</p> <ul><li>create a <code>layouts</code> folder with a default layout file;</li> <li>create a <code>pages</code> folder with <code>about</code> and <code>home</code> pages;</li> <li>add a <code>router.js</code> to the <code>src</code> folder root</li></ul> <p>To render this structure, you need to create it first inside the <code>generator/template</code> folder:</p> <p><img src="/generator-template.png" alt="Generator structure"></p> <p>After template is created, you should add <code>api.render</code> call to the <code>generator/index.js</code> file:</p> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token parameter">api</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  api<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token string">'./template'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="editing-existing-templates"><a href="#editing-existing-templates" aria-hidden="true" class="header-anchor">#</a> Editing existing templates</h3> <p>In addition, you can inherit and replace parts of an existing template file (even from another package) using YAML front-matter:</p> <div class="language-ejs extra-class"><pre class="language-ejs"><code>---
extend: '@vue/cli-service/generator/template/src/App.vue'
replace: !!js/regexp /<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript"><span class="token punctuation">[</span><span class="token operator">^</span><span class="token punctuation">]</span><span class="token operator">*</span><span class="token operator">?</span><span class="token operator">&lt;</span>\<span class="token regex">/script&gt;/</span>
<span class="token operator">--</span><span class="token operator">-</span>

<span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token comment">// Replace default script</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>It's also possible to do multiple replaces, although you will need to wrap your replace strings within <code>&lt;%# REPLACE %&gt;</code> and <code>&lt;%# END_REPLACE %&gt;</code> blocks:</p> <div class="language-ejs extra-class"><pre class="language-ejs"><code>---
extend: '@vue/cli-service/generator/template/src/App.vue'
replace:
  - !!js/regexp /Welcome to Your Vue\.js App/
  - !!js/regexp /<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript"><span class="token punctuation">[</span><span class="token operator">^</span><span class="token punctuation">]</span><span class="token operator">*</span><span class="token operator">?</span><span class="token operator">&lt;</span>\<span class="token regex">/script&gt;/</span>
<span class="token operator">--</span><span class="token operator">-</span>

<span class="token ejs language-ejs"><span class="token delimiter punctuation">&lt;%</span><span class="token comment"># REPLACE </span><span class="token delimiter punctuation">%&gt;</span></span>
Replace Welcome Message
<span class="token ejs language-ejs"><span class="token delimiter punctuation">&lt;%</span><span class="token comment"># END_REPLACE </span><span class="token delimiter punctuation">%&gt;</span></span>

<span class="token ejs language-ejs"><span class="token delimiter punctuation">&lt;%</span><span class="token comment"># REPLACE </span><span class="token delimiter punctuation">%&gt;</span></span>
<span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token comment">// Replace default script</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token ejs language-ejs"><span class="token delimiter punctuation">&lt;%</span><span class="token comment"># END_REPLACE </span><span class="token delimiter punctuation">%&gt;</span></span>
</code></pre></div><h3 id="filename-edge-cases"><a href="#filename-edge-cases" aria-hidden="true" class="header-anchor">#</a> Filename edge cases</h3> <p>If you want to render a template file that either begins with a dot (i.e. <code>.env</code>) you will have to follow a specific naming convention, since dotfiles are ignored when publishing your plugin to npm:</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># dotfile templates have to use an underscore instead of the dot:</span>

/generator/template/_env

<span class="token comment"># When calling api.render('./template'), this will be rendered in the project folder as:</span>

/generator/template/.env
</code></pre></div><p>Consequently, this means that you also have to follow a special naming convention if you want to render file whose name actually begins with an underscore:</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># such templates have to use two underscores instead of one:</span>

/generator/template/__variables.scss

<span class="token comment"># When calling api.render('./template'), this will be rendered in the project folder as:</span>

/generator/template/_variables.scss
</code></pre></div><h3 id="extending-package"><a href="#extending-package" aria-hidden="true" class="header-anchor">#</a> Extending package</h3> <p>If you need to add an additional dependency to the project, create a new npm script or modify <code>package.json</code> in any other way, you can use API <code>extendPackage</code> method.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// generator/index.js</span>

module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token parameter">api</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  api<span class="token punctuation">.</span><span class="token function">extendPackage</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    dependencies<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      <span class="token string">'vue-router-layout'</span><span class="token punctuation">:</span> <span class="token string">'^0.1.2'</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>In the example above we added one dependency: <code>vue-router-layout</code>. During the plugin invocation this npm module will be installed and this dependency will be added to the user <code>package.json</code> file.</p> <p>With the same API method we can add new npm tasks to the project. To do so, we need to specify task name and a command that should be run in the <code>scripts</code> section of the user <code>package.json</code>:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// generator/index.js</span>

module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token parameter">api</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  api<span class="token punctuation">.</span><span class="token function">extendPackage</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    scripts<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      greet<span class="token punctuation">:</span> <span class="token string">'vue-cli-service greet'</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>In the example above we're adding a new <code>greet</code> task to run a custom vue-cli service command created in <a href="#add-a-new-cli-service-command">Service section</a>.</p> <h3 id="changing-main-file"><a href="#changing-main-file" aria-hidden="true" class="header-anchor">#</a> Changing main file</h3> <p>With generator methods you can make changes to the project files. The most usual case is some modifications to <code>main.js</code> or <code>main.ts</code> file: new imports, new <code>Vue.use()</code> calls etc.</p> <p>Let's consider the case where we have created a <code>router.js</code> file via <a href="#creating-new-templates">templating</a> and now we want to import this router to the main file. We will use two Generator API methods: <code>entryFile</code> will return the main file of the project (<code>main.js</code> or <code>main.ts</code>) and <code>injectImports</code> serves for adding new imports to this file:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// generator/index.js</span>

api<span class="token punctuation">.</span><span class="token function">injectImports</span><span class="token punctuation">(</span>api<span class="token punctuation">.</span>entryFile<span class="token punctuation">,</span> <span class="token template-string"><span class="token string">`import router from './router'`</span></span><span class="token punctuation">)</span>
</code></pre></div><p>Now, when we have a router imported, we can inject this router to the Vue instance in the main file. We will use <code>onCreateComplete</code> hook which is to be called when the files have been written to disk.</p> <p>First, we need to read main file content with Node <code>fs</code> module (which provides an API for interacting with the file system) and split this content on lines:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// generator/index.js</span>

api<span class="token punctuation">.</span><span class="token function">onCreateComplete</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> contentMain <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span>api<span class="token punctuation">.</span>entryFile<span class="token punctuation">,</span> <span class="token punctuation">{</span> encoding<span class="token punctuation">:</span> <span class="token string">'utf-8'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> lines <span class="token operator">=</span> contentMain<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token regex">/\r?\n/g</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>Then we should to find the string containing <code>render</code> word (it's usually a part of Vue instance) and add our <code>router</code> as a next string:</p> <div class="language-js extra-class"><div class="highlight-lines"><br><br><br><br><br><br><br><div class="highlighted"> </div><div class="highlighted"> </div><br><br></div><pre class="language-js"><code><span class="token comment">// generator/index.js</span>

api<span class="token punctuation">.</span><span class="token function">onCreateComplete</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> contentMain <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span>api<span class="token punctuation">.</span>entryFile<span class="token punctuation">,</span> <span class="token punctuation">{</span> encoding<span class="token punctuation">:</span> <span class="token string">'utf-8'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> lines <span class="token operator">=</span> contentMain<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token regex">/\r?\n/g</span><span class="token punctuation">)</span>

  <span class="token keyword">const</span> renderIndex <span class="token operator">=</span> lines<span class="token punctuation">.</span><span class="token function">findIndex</span><span class="token punctuation">(</span><span class="token parameter">line</span> <span class="token operator">=&gt;</span> line<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span><span class="token regex">/render/</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  lines<span class="token punctuation">[</span>renderIndex<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token template-string"><span class="token string">`\n  router,`</span></span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>Finally, you need to write the content back to the main file:</p> <div class="language-js extra-class"><div class="highlight-lines"><br><div class="highlighted"> </div><br><br><br><br><br><br><br><br><div class="highlighted"> </div><br><br><br></div><pre class="language-js"><code><span class="token comment">// generator/index.js</span>

api<span class="token punctuation">.</span><span class="token function">onCreateComplete</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> <span class="token constant">EOL</span> <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'os'</span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> contentMain <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span>api<span class="token punctuation">.</span>entryFile<span class="token punctuation">,</span> <span class="token punctuation">{</span> encoding<span class="token punctuation">:</span> <span class="token string">'utf-8'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> lines <span class="token operator">=</span> contentMain<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token regex">/\r?\n/g</span><span class="token punctuation">)</span>

  <span class="token keyword">const</span> renderIndex <span class="token operator">=</span> lines<span class="token punctuation">.</span><span class="token function">findIndex</span><span class="token punctuation">(</span><span class="token parameter">line</span> <span class="token operator">=&gt;</span> line<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span><span class="token regex">/render/</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
   lines<span class="token punctuation">[</span>renderIndex<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token template-string"><span class="token string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token constant">EOL</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">  router,`</span></span>

  fs<span class="token punctuation">.</span><span class="token function">writeFileSync</span><span class="token punctuation">(</span>api<span class="token punctuation">.</span>entryFile<span class="token punctuation">,</span> lines<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token constant">EOL</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> encoding<span class="token punctuation">:</span> <span class="token string">'utf-8'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="service-plugin"><a href="#service-plugin" aria-hidden="true" class="header-anchor">#</a> Service Plugin</h2> <p>Service plugin serves for modifying webpack config, creating new vue-cli service commands or changing existing commands (such as <code>serve</code> and <code>build</code>).</p> <p>Service plugins are loaded automatically when a Service instance is created - i.e. every time the <code>vue-cli-service</code> command is invoked inside a project. It's located in the <code>index.js</code> file in CLI plugin root folder.</p> <p>A service plugin should export a function which receives two arguments:</p> <ul><li><p>A <a href="/nornj-cli/dev-guide/plugin-api.html">PluginAPI</a> instance</p></li> <li><p>An object containing project local options specified in <code>vue.config.js</code>, or in the <code>&quot;vue&quot;</code> field in <code>package.json</code>.</p></li></ul> <p>The minimal required code in the service plugin file is the following:</p> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre></div><h3 id="modifying-webpack-config"><a href="#modifying-webpack-config" aria-hidden="true" class="header-anchor">#</a> Modifying webpack config</h3> <p>The API allows service plugins to extend/modify the internal webpack config for different environments. For example, here we're modifying webpack config with webpack-chain to include <code>vue-auto-routing</code> webpack plugin with given parameters:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> VueAutoRoutingPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'vue-auto-routing/lib/webpack-plugin'</span><span class="token punctuation">)</span>

module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">api<span class="token punctuation">,</span> options</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  api<span class="token punctuation">.</span><span class="token function">chainWebpack</span><span class="token punctuation">(</span><span class="token parameter">webpackConfig</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    webpackConfig
      <span class="token punctuation">.</span><span class="token function">plugin</span><span class="token punctuation">(</span><span class="token string">'vue-auto-routing'</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>VueAutoRoutingPlugin<span class="token punctuation">,</span> <span class="token punctuation">[</span>
          <span class="token punctuation">{</span>
            pages<span class="token punctuation">:</span> <span class="token string">'src/pages'</span><span class="token punctuation">,</span>
            nested<span class="token punctuation">:</span> <span class="token boolean">true</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>You can also use <code>configureWebpack</code> method to modify the  webpack config or return object to be merged with webpack-merge.</p> <h3 id="add-a-new-cli-service-command"><a href="#add-a-new-cli-service-command" aria-hidden="true" class="header-anchor">#</a> Add a new cli-service command</h3> <p>With service plugin you can register a new cli-service command in addition to standard ones (i.e. <code>serve</code> and <code>build</code>). You can do it with a <code>registerCommand</code> API method.</p> <p>Here is an example of creating a simple new command that will print a greeting to developer console:</p> <div class="language-js extra-class"><pre class="language-js"><code>api<span class="token punctuation">.</span><span class="token function">registerCommand</span><span class="token punctuation">(</span>
  <span class="token string">'greet'</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    description<span class="token punctuation">:</span> <span class="token string">'Writes a greeting to the console'</span><span class="token punctuation">,</span>
    usage<span class="token punctuation">:</span> <span class="token string">'vue-cli-service greet'</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`👋  Hello`</span></span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">)</span>
</code></pre></div><p>In this example we provided the command name (<code>'greet'</code>), an object of command options with <code>description</code> and <code>usage</code>, and a function that will be run on <code>vue-cli-service greet</code> command.</p> <div class="tip custom-block"><p>You can add new command to the list of project npm scripts inside the <code>package.json</code> file <a href="#extending-package">via Generator</a>.</p></div> <p>If you try to run a new command in the project with your plugin installed, you will see the following output:</p> <div class="language-bash extra-class"><pre class="language-bash"><code>$ vue-cli-service greet
👋 Hello<span class="token operator">!</span>
</code></pre></div><p>You can also specify a list of available options for a new command. Let's add the option <code>--name</code> and change the function to print this name if it's provided.</p> <div class="language-js extra-class"><pre class="language-js"><code>api<span class="token punctuation">.</span><span class="token function">registerCommand</span><span class="token punctuation">(</span>
  <span class="token string">'greet'</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    description<span class="token punctuation">:</span> <span class="token string">'Writes a greeting to the console'</span><span class="token punctuation">,</span>
    usage<span class="token punctuation">:</span> <span class="token string">'vue-cli-service greet [options]'</span><span class="token punctuation">,</span>
    options<span class="token punctuation">:</span> <span class="token punctuation">{</span> <span class="token string">'--name'</span><span class="token punctuation">:</span> <span class="token string">'specifies a name for greeting'</span> <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token parameter">args</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>args<span class="token punctuation">.</span>name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`👋 Hello, </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>args<span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">!`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`👋 Hello!`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Now, if you a <code>greet</code> command with a specified <code>--name</code> option, this name will be added to console message:</p> <div class="language-bash extra-class"><pre class="language-bash"><code>$ vue-cli-service greet --name <span class="token string">'John Doe'</span>
👋 Hello, John Doe<span class="token operator">!</span>
</code></pre></div><h3 id="modifying-existing-cli-service-command"><a href="#modifying-existing-cli-service-command" aria-hidden="true" class="header-anchor">#</a> Modifying existing cli-service command</h3> <p>If you want to modify an existing cli-service command, you can retrieve it with <code>api.service.commands</code> and add some changes. We're going to print a message to the console with a port where application is running:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token punctuation">{</span> serve <span class="token punctuation">}</span> <span class="token operator">=</span> api<span class="token punctuation">.</span>service<span class="token punctuation">.</span>commands

<span class="token keyword">const</span> serveFn <span class="token operator">=</span> serve<span class="token punctuation">.</span>fn

serve<span class="token punctuation">.</span><span class="token function-variable function">fn</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token operator">...</span>args</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token function">serveFn</span><span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>res <span class="token operator">&amp;&amp;</span> res<span class="token punctuation">.</span>url<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`Project is running now at </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>res<span class="token punctuation">.</span>url<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>In the example above we retrieve the <code>serve</code> command from the list of existing commands; then we modify its <code>fn</code> part (<code>fn</code> is the third parameter passed when you create a new command; it specifies the function to run when running the command). With the modification done the console message will be printed after <code>serve</code> command has run successfully.</p> <h3 id="specifying-mode-for-commands"><a href="#specifying-mode-for-commands" aria-hidden="true" class="header-anchor">#</a> Specifying Mode for Commands</h3> <p>If a plugin-registered command needs to run in a specific default mode, the plugin needs to expose it via <code>module.exports.defaultModes</code> in the form of <code>{ [commandName]: mode }</code>:</p> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token parameter">api</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  api<span class="token punctuation">.</span><span class="token function">registerCommand</span><span class="token punctuation">(</span><span class="token string">'build'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

module<span class="token punctuation">.</span>exports<span class="token punctuation">.</span>defaultModes <span class="token operator">=</span> <span class="token punctuation">{</span>
  build<span class="token punctuation">:</span> <span class="token string">'production'</span>
<span class="token punctuation">}</span>
</code></pre></div><p>This is because the command's expected mode needs to be known before loading environment variables, which in turn needs to happen before loading user options / applying the plugins.</p> <h2 id="prompts"><a href="#prompts" aria-hidden="true" class="header-anchor">#</a> Prompts</h2> <p>Prompts are required to handle user choices when creating a new project or adding a new plugin to the existing one. All prompts logic is stored inside the <code>prompts.js</code> file. The prompts are presented using <a href="https://github.com/SBoudrias/Inquirer.js" target="_blank" rel="noopener noreferrer">inquirer<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> under the hood.</p> <p>When user initialize the plugin by calling <code>vue invoke</code>, if the plugin contains a <code>prompts.js</code> in its root directory, it will be used during invocation. The file should export an array of <a href="https://github.com/SBoudrias/Inquirer.js#question" target="_blank" rel="noopener noreferrer">Questions<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> that will be handled by Inquirer.js.</p> <p>You should export directly array of questions, or export function that return those.</p> <p>e.g. directly array of questions:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// prompts.js</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    type<span class="token punctuation">:</span> <span class="token string">'input'</span><span class="token punctuation">,</span>
    name<span class="token punctuation">:</span> <span class="token string">'locale'</span><span class="token punctuation">,</span>
    message<span class="token punctuation">:</span> <span class="token string">'The locale of project localization.'</span><span class="token punctuation">,</span>
    <span class="token function-variable function">validate</span><span class="token punctuation">:</span> <span class="token parameter">input</span> <span class="token operator">=&gt;</span> <span class="token operator">!</span><span class="token operator">!</span>input<span class="token punctuation">,</span>
    <span class="token keyword">default</span><span class="token punctuation">:</span> <span class="token string">'en'</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> 
  <span class="token comment">// ...</span>
<span class="token punctuation">]</span>
</code></pre></div><p>e.g. function that return array of questions:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// prompts.js</span>

<span class="token comment">// pass `package.json` of project to function argument</span>
module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token parameter">pkg</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> prompts <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      type<span class="token punctuation">:</span> <span class="token string">'input'</span><span class="token punctuation">,</span>
      name<span class="token punctuation">:</span> <span class="token string">'locale'</span><span class="token punctuation">,</span>
      message<span class="token punctuation">:</span> <span class="token string">'The locale of project localization.'</span><span class="token punctuation">,</span>
      <span class="token function-variable function">validate</span><span class="token punctuation">:</span> <span class="token parameter">input</span> <span class="token operator">=&gt;</span> <span class="token operator">!</span><span class="token operator">!</span>input<span class="token punctuation">,</span>
      <span class="token keyword">default</span><span class="token punctuation">:</span> <span class="token string">'en'</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>

  <span class="token comment">// add dynamically propmpt</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string">'@vue/cli-plugin-eslint'</span> <span class="token keyword">in</span> <span class="token punctuation">(</span>pkg<span class="token punctuation">.</span>devDependencies <span class="token operator">||</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    prompts<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      type<span class="token punctuation">:</span> <span class="token string">'confirm'</span><span class="token punctuation">,</span>
      name<span class="token punctuation">:</span> <span class="token string">'useESLintPluginVueI18n'</span><span class="token punctuation">,</span>
      message<span class="token punctuation">:</span> <span class="token string">'Use ESLint plugin for Vue I18n ?'</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> prompts
<span class="token punctuation">}</span>
</code></pre></div><p>The resolved answers object will be passed to the plugin's generator as options.</p> <p>Alternatively, the user can skip the prompts and directly initialize the plugin by passing options via the command line, e.g.:</p> <div class="language-bash extra-class"><pre class="language-bash"><code>vue invoke my-plugin --mode awesome
</code></pre></div><p>Prompt can have <a href="https://github.com/SBoudrias/Inquirer.js#prompt-types" target="_blank" rel="noopener noreferrer">different types<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> but the most widely used in CLI are <code>checkbox</code> and <code>confirm</code>. Let's add a <code>confirm</code> prompt and then use it in plugin generator to create a condition for <a href="#creating-new-templates">template rendering</a>.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// prompts.js</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    name<span class="token punctuation">:</span> <span class="token template-string"><span class="token string">`addExampleRoutes`</span></span><span class="token punctuation">,</span>
    type<span class="token punctuation">:</span> <span class="token string">'confirm'</span><span class="token punctuation">,</span>
    message<span class="token punctuation">:</span> <span class="token string">'Add example routes?'</span><span class="token punctuation">,</span>
    <span class="token keyword">default</span><span class="token punctuation">:</span> <span class="token boolean">false</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">]</span>
</code></pre></div><p>On plugin invoke user will be prompted with the question about example routes and the default answer will be <code>No</code>.</p> <p><img src="/prompts-example.png" alt="Prompts example"></p> <p>If you want to use the result of the user's choice in generator, it will be accessible with the prompt name. We can add a modification to <code>generator/index.js</code>:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">if</span> <span class="token punctuation">(</span>options<span class="token punctuation">.</span>addExampleRoutes<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  api<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token string">'./template'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span>options
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Now template will be rendered only if user agreed to create example routes.</p> <h2 id="installing-plugin-locally"><a href="#installing-plugin-locally" aria-hidden="true" class="header-anchor">#</a> Installing plugin locally</h2> <p>While working on your plugin, you need to test it and check how it works locally on a project using Vue CLI. You can use an existing project or create a new one just for testing purposes:</p> <div class="language-bash extra-class"><pre class="language-bash"><code>vue create test-app
</code></pre></div><p>To add the plugin, run the following command in the root folder of the project:</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">npm</span> <span class="token function">install</span> --save-dev file:/full/path/to/your/plugin
vue invoke <span class="token operator">&lt;</span>your-plugin-name<span class="token operator">&gt;</span>
</code></pre></div><p>You need to repeat these steps every time you make changes to your plugin.</p> <p>Another way to add a plugin is to leverage the power of Vue UI. You can run it with:</p> <div class="language-bash extra-class"><pre class="language-bash"><code>vue ui
</code></pre></div><p>You will have a UI open in browser window on <code>localhost:8000</code>. Go to the <code>Vue Project Manager</code> tab:</p> <p><img src="/ui-project-manager.png" alt="Vue Project Manager"></p> <p>And look for your test project name there:</p> <p><img src="/ui-select-plugin.png" alt="UI Plugins List"></p> <p>Click on your application name, go to the Plugins tab (it has a puzzle icon) and then click the <code>Add new plugin</code> button on the top right. In the new view you will see a list of Vue CLI plugins accessible via npm. There is also a <code>Browse local plugin</code> button on the bottom of the page:</p> <p><img src="/ui-browse-local-plugin.png" alt="Browse local plugins"></p> <p>After you click it, you can easily search for you plugin and add it to the project. After this you will be able to see it in plugins list and apply all changes done to the plugin via simply clicking on <code>Refresh</code> icon:</p> <p><img src="/ui-plugin-refresh.png" alt="Refresh plugin"></p> <h2 id="ui-integration"><a href="#ui-integration" aria-hidden="true" class="header-anchor">#</a> UI Integration</h2> <p>Vue CLI has a great UI tool which allows user to scaffold and manage a project with a nice graphical interface. The Vue CLI plugin can be integrated to this interface. UI provides an additional functionality to CLI plugins:</p> <ul><li>you can run npm tasks, including plugin-specific ones, directly from the UI;</li> <li>you can display custom configurations for your plugin. For example, <a href="https://github.com/Akryum/vue-cli-plugin-apollo" target="_blank" rel="noopener noreferrer">vue-cli-plugin-apollo<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> provides the following configuration screen for Apollo server:</li></ul> <p><img src="/ui-configuration.png" alt="UI Configuration Screen"></p> <ul><li>when creating the project, you can display <a href="#prompts">prompts</a> visually</li> <li>you can add localizations for your plugin if you want to support multiple languages</li> <li>you can make your plugin discoverable in the Vue UI search</li></ul> <p>All the logic connected to Vue UI should be placed to <code>ui.js</code> file in the root folder or in the <code>ui/index.js</code>. The file should export a function which gets the api object as argument:</p> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token parameter">api</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// Use the API here...</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="augment-the-task-in-the-ui"><a href="#augment-the-task-in-the-ui" aria-hidden="true" class="header-anchor">#</a> Augment the task in the UI</h3> <p>Vue CLI plugin allows you not only add new npm tasks to the project <a href="#extending-package">via Generator</a> but also create a view for them in Vue UI. It's useful when you want to run the the task right from the UI and see its output there.</p> <p>Let's add a <code>greet</code> task created with <a href="#extending-package">Generator</a> to the UI. Tasks are generated from the <code>scripts</code> field in the project <code>package.json</code> file. You can 'augment' the tasks with additional info and hooks thanks to the <code>api.describeTask</code> method. Let's provide some additional information about our task:</p> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token parameter">api</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  api<span class="token punctuation">.</span><span class="token function">describeTask</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    match<span class="token punctuation">:</span> <span class="token regex">/greet/</span><span class="token punctuation">,</span>
    description<span class="token punctuation">:</span> <span class="token string">'Prints a greeting in the console'</span><span class="token punctuation">,</span>
    link<span class="token punctuation">:</span> <span class="token string">'https://cli.vuejs.org/dev-guide/plugin-dev.html#core-concepts'</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Now if you explore your project in the Vue UI, you will find your task added to the <code>Tasks</code> section. You can see a name of the task, provided description, a link icon that leads to the provided URL and also an output screen to show the task output:</p> <p><img src="/ui-greet-task.png" alt="UI Greet task"></p> <h3 id="display-a-configuration-screen"><a href="#display-a-configuration-screen" aria-hidden="true" class="header-anchor">#</a> Display a configuration screen</h3> <p>Sometimes your project can have custom configuration files for different features or libraries. With Vue CLI plugin you can display this config in Vue UI, change it and save (saving will change the corresponding config file in your project). By default, Vue CLI project has a main configuration screen representing <code>vue.config.js</code> settings. If you included ESLint to your project, you will see also a ESLint configuration screen:</p> <p><img src="/ui-configuration-default.png" alt="UI Configuration Screen"></p> <p>Let's build a custom configuration for our plugin. First of all, after you add your plugin to the existing project, there should be a file containing this custom config. This means you need to add this file to <code>template</code> folder on the <a href="#creating-new-templates">templating step</a>.</p> <p>By default, a configuration UI might read and write to the following file types: <code>json</code>, <code>yaml</code>, <code>js</code>, <code>package</code>. Let's name our new file <code>myConfig.js</code> and place in it the root of <code>template</code> folder:</p> <div class="language- extra-class"><pre class="language-text"><code>.
└── generator
    ├── index.js
    └── template
        ├── myConfig.js
        └── src
            ├── layouts
            ├── pages
            └── router.js
</code></pre></div><p>Now you need to add some actual config to this file:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// myConfig.js</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  color<span class="token punctuation">:</span> <span class="token string">'black'</span>
<span class="token punctuation">}</span>
</code></pre></div><p>After your plugin is invoked, the <code>myConfig.js</code> file will be rendered in the project root directory. Now let's add a new configuration screen with the <code>api.describeConfig</code> method in the <code>ui.js</code> file:</p> <p>First you need to pass some information:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// ui.js</span>

api<span class="token punctuation">.</span><span class="token function">describeConfig</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token comment">// Unique ID for the config</span>
  id<span class="token punctuation">:</span> <span class="token string">'org.ktsn.vue-auto-routing.config'</span><span class="token punctuation">,</span>
  <span class="token comment">// Displayed name</span>
  name<span class="token punctuation">:</span> <span class="token string">'Greeting configuration'</span><span class="token punctuation">,</span>
  <span class="token comment">// Shown below the name</span>
  description<span class="token punctuation">:</span> <span class="token string">'This config defines the color of the greeting printed'</span><span class="token punctuation">,</span>
  <span class="token comment">// &quot;More info&quot; link</span>
  link<span class="token punctuation">:</span> <span class="token string">'https://github.com/ktsn/vue-cli-plugin-auto-routing#readme'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><div class="danger custom-block"><p class="custom-block-title">Warning</p> <p>Make sure to namespace the id correctly, since it must be unique across all plugins. It's recommended to use the <a href="https://en.wikipedia.org/wiki/Reverse_domain_name_notation" target="_blank" rel="noopener noreferrer">reverse domain name notation<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></div> <h4 id="config-logo"><a href="#config-logo" aria-hidden="true" class="header-anchor">#</a> Config logo</h4> <p>You can also select an icon for your config. It can be either a <a href="https://material.io/tools/icons/?style=baseline" target="_blank" rel="noopener noreferrer">Material icon<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> code or a custom image (see <a href="/nornj-cli/dev-guide/ui-api.html#public-static-files">Public static files</a>).</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// ui.js</span>

api<span class="token punctuation">.</span><span class="token function">describeConfig</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token comment">/* ... */</span>
  <span class="token comment">// Config icon</span>
  icon<span class="token punctuation">:</span> <span class="token string">'color_lens'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>If you don't specify an icon, the plugin logo will be displayed if any (see <a href="#logo">Logo</a>).</p> <h4 id="config-files"><a href="#config-files" aria-hidden="true" class="header-anchor">#</a> Config files</h4> <p>Now you need to provide your configuration file to UI: this way you could read its content and save changes to it. You need to choose a name for your config file, select its format and provide a path to the file:</p> <div class="language-js extra-class"><pre class="language-js"><code>api<span class="token punctuation">.</span><span class="token function">describeConfig</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token comment">// other config properties</span>
  files<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    myConfig<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      js<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'myConfig.js'</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>There can be more than one file provided. Say, if we have <code>myConfig.json</code>, we can provide it with <code>json: ['myConfig.json']</code> property. The order is important: the first filename in the list will be used to create the config file if it doesn't exist.</p> <h4 id="display-config-prompts"><a href="#display-config-prompts" aria-hidden="true" class="header-anchor">#</a> Display config prompts</h4> <p>We want to display an input field for color property on the configuration screen. To do so, we need a <code>onRead</code> hook that will return a list of prompts to be displayed:</p> <div class="language-js extra-class"><pre class="language-js"><code>api<span class="token punctuation">.</span><span class="token function">describeConfig</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token comment">// other config properties</span>
  <span class="token function-variable function">onRead</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> data <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
    prompts<span class="token punctuation">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        name<span class="token punctuation">:</span> <span class="token template-string"><span class="token string">`color`</span></span><span class="token punctuation">,</span>
        type<span class="token punctuation">:</span> <span class="token string">'input'</span><span class="token punctuation">,</span>
        message<span class="token punctuation">:</span> <span class="token string">'Define the color for greeting message'</span><span class="token punctuation">,</span>
        value<span class="token punctuation">:</span> <span class="token string">'white'</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>In the example above we specified the input prompt with the value of 'white'. This is how our configuration screen will look with all the settings provided above:</p> <p><img src="/ui-config-start.png" alt="UI Config Start"></p> <p>Now let's replace hardcoded <code>white</code> value with the property from the config file. In the <code>onRead</code> hook <code>data</code> object contains the JSON result of each config file content. In our case, the content of <code>myConfig.js</code> was</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// myConfig.js</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  color<span class="token punctuation">:</span> <span class="token string">'black'</span>
<span class="token punctuation">}</span>
</code></pre></div><p>So, the <code>data</code> object will be</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">{</span>
  <span class="token comment">// File</span>
  myConfig<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// File data</span>
    color<span class="token punctuation">:</span> <span class="token string">'black'</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>It's easy to see that we need <code>data.myConfig.color</code> property. Let's change <code>onRead</code> hook:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// ui.js</span>

<span class="token function-variable function">onRead</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> data <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
  prompts<span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      name<span class="token punctuation">:</span> <span class="token template-string"><span class="token string">`color`</span></span><span class="token punctuation">,</span>
      type<span class="token punctuation">:</span> <span class="token string">'input'</span><span class="token punctuation">,</span>
      message<span class="token punctuation">:</span> <span class="token string">'Define the color for greeting message'</span><span class="token punctuation">,</span>
      value<span class="token punctuation">:</span> data<span class="token punctuation">.</span>myConfig <span class="token operator">&amp;&amp;</span> data<span class="token punctuation">.</span>myConfig<span class="token punctuation">.</span>color
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
</code></pre></div><div class="tip custom-block"><p>Note that <code>myConfig</code> may be undefined if the config file doesn't exist when the screen is loaded.</p></div> <p>You can see that on the configuration screen <code>white</code> is replaced with <code>black</code>.</p> <p>We can also provide a default value if the config file is not present:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// ui.js</span>

<span class="token function-variable function">onRead</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> data <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
  prompts<span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      name<span class="token punctuation">:</span> <span class="token template-string"><span class="token string">`color`</span></span><span class="token punctuation">,</span>
      type<span class="token punctuation">:</span> <span class="token string">'input'</span><span class="token punctuation">,</span>
      message<span class="token punctuation">:</span> <span class="token string">'Define the color for greeting message'</span><span class="token punctuation">,</span>
      value<span class="token punctuation">:</span> data<span class="token punctuation">.</span>myConfig <span class="token operator">&amp;&amp;</span> data<span class="token punctuation">.</span>myConfig<span class="token punctuation">.</span>color<span class="token punctuation">,</span>
      <span class="token keyword">default</span><span class="token punctuation">:</span> <span class="token string">'black'</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
</code></pre></div><h4 id="save-config-changes"><a href="#save-config-changes" aria-hidden="true" class="header-anchor">#</a> Save config changes</h4> <p>We just read the content of <code>myConfig.js</code> and used it on the configuration screen. Now let's try to save any changes done in the color input field to the file. We can do it with the <code>onWrite</code> hook:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// ui.js</span>

api<span class="token punctuation">.</span><span class="token function">describeConfig</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token comment">/* ... */</span>
  <span class="token function-variable function">onWrite</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> prompts<span class="token punctuation">,</span> api <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p><code>onWrite</code> hook can take a lot of <a href="/nornj-cli/dev-guide/ui-api.html#save-config-changes">arguments</a> but we will need only two of them: <code>prompts</code> and <code>api</code>. First one is current prompts runtime objects - we will get a prompt id from it and retrieve an answer with this id. To retrieve the answer we'll use <code>async getAnswer()</code> method from the <code>api</code>:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// ui.js</span>

<span class="token keyword">async</span> <span class="token function">onWrite</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> api<span class="token punctuation">,</span> prompts <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> prompt <span class="token keyword">of</span> prompts<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    result<span class="token punctuation">[</span><span class="token template-string"><span class="token string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>prompt<span class="token punctuation">.</span>id<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">await</span> api<span class="token punctuation">.</span><span class="token function">getAnswer</span><span class="token punctuation">(</span>prompt<span class="token punctuation">.</span>id<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  api<span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token string">'myConfig'</span><span class="token punctuation">,</span> result<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Now if you try to change the value in the color input field from <code>black</code> to <code>red</code> on the config screen and press <code>Save the changes</code>, you will observe that <code>myConfig.js</code> file in your project has been changed as well:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// myConfig.js</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  color<span class="token punctuation">:</span> <span class="token string">'red'</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="display-prompts"><a href="#display-prompts" aria-hidden="true" class="header-anchor">#</a> Display prompts</h3> <p>If you want, you can display <a href="#prompts">prompts</a> in the Vue UI as well. When installing your plugin through the UI, prompts will be shown on the plugin invocation step.</p> <p>You can extend the <a href="#prompts-for-3rd-party-plugins">inquirer object</a> with additional properties. They are optional and only used by the UI:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// prompts.js</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    <span class="token comment">// basic prompt properties</span>
    name<span class="token punctuation">:</span> <span class="token template-string"><span class="token string">`addExampleRoutes`</span></span><span class="token punctuation">,</span>
    type<span class="token punctuation">:</span> <span class="token string">'confirm'</span><span class="token punctuation">,</span>
    message<span class="token punctuation">:</span> <span class="token string">'Add example routes?'</span><span class="token punctuation">,</span>
    <span class="token keyword">default</span><span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token comment">// UI-related prompt properties</span>
    group<span class="token punctuation">:</span> <span class="token string">'Strongly recommended'</span><span class="token punctuation">,</span>
    description<span class="token punctuation">:</span> <span class="token string">'Adds example pages, layouts and correct router config'</span><span class="token punctuation">,</span>
    link<span class="token punctuation">:</span>
      <span class="token string">'https://github.com/ktsn/vue-cli-plugin-auto-routing/#vue-cli-plugin-auto-routing'</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">]</span>
</code></pre></div><p>As a result, you will have this screen on plugin invocation:</p> <p><img src="/ui-prompts.png" alt="UI Prompts"></p> <h3 id="logo"><a href="#logo" aria-hidden="true" class="header-anchor">#</a> Logo</h3> <p>You can put a <code>logo.png</code> file in the root directory of the folder that will be published on npm. It will be displayed in several places:</p> <ul><li>When searching for a plugin to install</li> <li>In the installed plugin list</li> <li>In the configurations list (by default)</li> <li>In the tasks list for augmented tasks (by default)</li></ul> <p><img src="/plugins.png" alt="Plugins"></p> <p>The logo should be a square non-transparent image (ideally 84x84).</p> <h2 id="publish-plugin-to-npm"><a href="#publish-plugin-to-npm" aria-hidden="true" class="header-anchor">#</a> Publish Plugin to npm</h2> <p>To publish your plugin, you need to be registered an <a href="npmjs.com">npmjs.com</a> and you should have <code>npm</code> installed globally. If it's your first npm module, please run</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">npm</span> login
</code></pre></div><p>Enter your username and password. This will store the credentials so you don’t have to enter it for every publish.</p> <div class="tip custom-block"><p>Before publishing a plugin, make sure you choose a right name for it! Name convention is <code>vue-cli-plugin-&lt;name&gt;</code>. Check <a href="#discoverability">Discoverability</a> section for more information</p></div> <p>To publish a plugin, go to the plugin root folder and run this command in the terminal:</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">npm</span> publish
</code></pre></div><p>After successful publish, you should be able to add your plugin to the project created with Vue CLI with <code>vue add &lt;plugin-name&gt;</code> command.</p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/joe-sky/nornj-cli/edit/master/docs/dev-guide/plugin-dev.md" target="_blank" rel="noopener noreferrer">Edit this page on GitHub</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">Last Updated: </span> <span class="time">6/24/2019, 7:53:13 PM</span></div></footer> <div class="page-nav"><p class="inner"><!----> <span class="next"><a href="/nornj-cli/dev-guide/plugin-api.html">
          Plugin API
        </a>
        →
      </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/nornj-cli/assets/js/app.261fa4a4.js" defer></script><script src="/nornj-cli/assets/js/3.bc847c09.js" defer></script><script src="/nornj-cli/assets/js/20.3cd1f9b8.js" defer></script>
  </body>
</html>
